{%- assign product_form_id = 'product-form-' | append: section.id -%}
<script>
  document.addEventListener("DOMContentLoaded", function() {
    validador.Img2 = false;
  })

    function sonTodosVerdaderos(objeto) {
    return Object.values(objeto).every(valor => valor === true);
  }
</script>
<div class="file_container2">
  <p class="line-item-property__field">
    <!-- Solo un botón ahora, no un input -->
    <button type="button" id="openmodal2Button2" class="input-preview2">Agrega la segunda imagen</button>
  </p>
</div>

<!-- modal2 HTML -->
<div id="recommendationmodal2" class="modal2">
  <div class="modal2-content">
    <h2>Consideraciones:</h2>
    <p>
      Antes de subir tu fotografía, asegúrate de seguir las <em><b>Recomendaciones para una buena foto</b></em
      >, estas las encontrarás en la descripción de este accesorio.
    </p>
    <!-- Este es el botón dentro del modal2 que abre el cuadro de selección de archivos -->
    <button id="confirmButton2">¡Listo! Agregar Imagen</button>

    <!-- El input de tipo "file" ahora está dentro del modal2 y está oculto -->
    <input
      form="{{ product_form_id }}"
      id="img2"
      class="input-preview2__src"
      type="file"
      name="properties[Segunda imagen]"
      accept="image/png, image/jpeg"
      style="display:none;"
    >
    <button id="closeButton2" class="input-preview2__src">Cerrar</button>
  </div>
</div>

<script>
  document.addEventListener("DOMContentLoaded", function() {
    validador.Img2 = false;

    const fileImage2 = document.querySelector('#img2');
    const openmodal2Button2 = document.getElementById("openmodal2Button2");
    const filePreview2 = document.querySelector('.input-preview2');

    // Direct file picker on button click
    openmodal2Button2.onclick = function() {
      fileImage2.click();
    };

    // Preview image on file selection
    fileImage2.onchange = function() {
      const reader2 = new FileReader();
      reader2.onload = function(e) {
        filePreview2.style.height = "170px";
        filePreview2.style.backgroundImage = "url(" + e.target.result + ")";
        filePreview2.classList.add("has-image");
        validador.Img2 = true;

        if(sonTodosVerdaderos(validador)){
          addToCartButton.disabled = false;
        }
      };
      reader2.readAsDataURL(this.files[0]);
    };
  });
</script>

<style>
  #confirmButton2, #closeButton2 {
    background-color: #35392b;
    color: white;
    font-size: 14px;
    padding: 10px 20px;
    border: none;
    border-radius: 20px;
    cursor: pointer;
    width: 70%;
    margin: 10px auto;
    display: block;
    text-align: center;
    white-space: nowrap;
  }

  #confirmButton2:hover, #closeButton2:hover {
    background-color: #454d3a;
  }

  .line-item-property__field {
    margin: 0px;
  }

  .file_container2 {
    width: 200px;
    display: flex;
    flex-direction: column;
    align-items: flex-start;
    padding: 0;
  }

  .input-preview2 {
      font-family: Assistant, sans-serif;
      border-radius: 30px;
      background-color: #35392b;
      color: white;
      font-size: 14px;
      width: auto;
      padding: 10px 20px;
      display: flex;
      justify-content: center;
      align-items: center;
      cursor: pointer;
      background-size: cover;
      background-repeat: no-repeat;
      background-position: center;
      transition: ease-in-out 750ms;
      position: relative;
      margin: .7rem .5rem .2rem 0;
      white-space: nowrap;
  }

  .input-preview2:hover {
    background-color: #454d3a;
  }

  .input-preview2__src {
    display: none;
  }

  .input-preview2::after {
    content: "";
    text-align: center;
    font-size: 1em;
  }

  .has-image::before {
    border-radius: 20px;
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(50, 50, 50, 0.2);
    content: " ";
    transition: ease-in-out 750ms;
  }

  .has-image::after {
    color: white;
  }

  /* modal2 styling */
  .modal2 {
    display: none;
    position: fixed;
    z-index: 9999;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    overflow: auto;
  }

  .modal2-content {
    background-color: #fefefe;
    margin: 10% auto;
    padding: 20px;
    border: 1px solid #888;
    width: 80%;
    max-width: 500px;
    border-radius: 10px;
    text-align: center;
  }

  .modal2-content h2 {
    margin-top: 0;
  }

  .modal2-content ul {
    list-style: none;
    padding: 0;
  }

  .modal2-content ul li {
    text-align: left;
    padding: 8px 0;
  }
</style>
